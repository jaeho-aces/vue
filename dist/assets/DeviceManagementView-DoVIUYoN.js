import{B as O,T as W,D as _e}from"./Table-hvhpEn92.js";import{O as X,P as E,i as pe,Q as G,d as f,u as J,r as Y,m as k,k as Q,n as he,c as ne,F as le,p as $,y as K,g as me,R as q,D as B,o as A,T as x,j as R,b as se,s as ve,z as fe,t as ge,B as be}from"./index-DUpAoUQv.js";const ye=10,oe=100,Ce=5*60*1e3,ie=X("videoConversionInfo",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.ch_id===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>{var l,u,b;return r.ch_id.toLowerCase().includes(s)||r.cctv_id.toLowerCase().includes(s)||((l=r.hq_code)==null?void 0:l.toLowerCase().includes(s))||((u=r.branch_code)==null?void 0:u.toLowerCase().includes(s))||((b=r.route_code)==null?void 0:b.toLowerCase().includes(s))})}},actions:{transformFromAPI(e){return{ch_id:e.ch_id||"",cctv_id:e.cctv_id||"",trans_id:e.trans_id||"",fms_id:e.fms_id||"",ch_venc:e.ch_venc||"",ch_vsize:e.ch_vsize||"",ch_vfps:e.ch_vfps||"",ch_vkpbs:e.ch_vkpbs||"",ch_alive:e.ch_alive||"",ch_alive_time:e.ch_alive_time||null,ch_alive_yn:e.ch_alive_yn||"",reg_date:e.reg_date||"",json_job:e.json_job||"",json_yn:e.json_yn||"",json_date:e.json_date||"",kt_cctv:e.kt_cctv||"",ch_wmv_yn:e.ch_wmv_yn||"",ch_wmv_venc:e.ch_wmv_venc||"",ch_wmv_vsize:e.ch_wmv_vsize||"",ch_wmv_vfps:e.ch_wmv_vfps||"",ch_wmv_vkpbs:e.ch_wmv_vkpbs||"",sms_session:e.sms_session||"",sms_host_ip:e.sms_host_ip||"",sms_date:e.sms_date||null,job_status:e.job_status||"",ch_jpg_size:e.ch_jpg_size||"",ch_jpg_kbps:e.ch_jpg_kbps||"",ch_jpg_keep_count:e.ch_jpg_keep_count||0,hq_code:e.hq_code,branch_code:e.branch_code,route_code:e.route_code}},transformToAPI(e){return{ch_id:e.ch_id,cctv_id:e.cctv_id,trans_id:e.trans_id,fms_id:e.fms_id,ch_venc:e.ch_venc,ch_vsize:e.ch_vsize,ch_vfps:e.ch_vfps,ch_vkpbs:e.ch_vkpbs,ch_alive:e.ch_alive,ch_alive_time:e.ch_alive_time,ch_alive_yn:e.ch_alive_yn,reg_date:e.reg_date,json_job:e.json_job,json_yn:e.json_yn,json_date:e.json_date,kt_cctv:e.kt_cctv,ch_wmv_yn:e.ch_wmv_yn,ch_wmv_venc:e.ch_wmv_venc,ch_wmv_vsize:e.ch_wmv_vsize,ch_wmv_vfps:e.ch_wmv_vfps,ch_wmv_vkpbs:e.ch_wmv_vkpbs,sms_session:e.sms_session,sms_host_ip:e.sms_host_ip,sms_date:e.sms_date,job_status:e.job_status,ch_jpg_size:e.ch_jpg_size,ch_jpg_kbps:e.ch_jpg_kbps,ch_jpg_keep_count:e.ch_jpg_keep_count}},getHelper(){return new G("/video-conversion-info",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_CHANNEL"},getPhpTableKey(){return"CH_ID"},async waitForCommonCode(e=ye){const t=E();if(t.items.length===0&&!t.isLoading&&await t.fetchCommonCodes(),t.isLoading){const s=e*1e3/oe;let r=0;for(;t.isLoading&&r<s;)await new Promise(l=>setTimeout(l,oe)),r++;if(r>=s)return console.warn("CommonCode 로딩 타임아웃: 매핑을 건너뜁니다."),!1}return t.items.length>0},async fetchVideoConversions(e=!1){await this.getHelper().fetchAll(e,Ce,"영상변환 채널정보 데이터",this.getPhpTableName()),await this.waitForCommonCode(),E().items.length>0&&this.items.length>0&&await this.mapCodeNames()},async mapCodeNames(){if(!await this.waitForCommonCode()||this.items.length===0)return;const t=E(),s=[...new Set(this.items.map(r=>r.cctv_id).filter(r=>r&&r.trim()!==""))];if(s.length!==0)try{const r=await pe.fastapi.getDbArray("MGMT_CCTV",{layout:[{field:"CCTV_ID"},{field:"HQ_CODE"},{field:"BRANCH_CODE"},{field:"ROUTE_CODE"}],query:s.map(y=>({cctv_id:y})),where:"",order:""}),l=Array.isArray(r.data)?r.data:[],u=new Map;l.forEach(y=>{const T=(y.cctv_id||y.cctv_ID||"").toLowerCase();T&&u.set(T,{hq_code:y.hq_code||y.hq_CODE||"",branch_code:y.branch_code||y.branch_CODE||"",route_code:y.route_code||y.route_CODE||""})});const b=this.items.map(y=>{var L,z,j;const T=(y.cctv_id||"").toLowerCase(),C=u.get(T);if(C){const D=((L=C.hq_code)==null?void 0:L.trim())||"",p=((z=C.branch_code)==null?void 0:z.trim())||"",n=((j=C.route_code)==null?void 0:j.trim())||"",c=D?t.getCodeNameByGbn("1",D):"",v=p?t.getCodeNameByGbn("2",p):"",i=n?t.getCodeNameByGbn("4",n):"";return{...y,hq_code:c||D,branch_code:v||p,route_code:i||n}}return y});this.items=[...b]}catch(r){const l=r instanceof Error?r.message:"알 수 없는 오류",u=r instanceof Error?r.stack:void 0;console.error("소속 본부/노선 데이터 매핑 실패:",{message:l,stack:u,error:r})}},async createVideoConversion(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateVideoConversion(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteVideoConversion(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteVideoConversions(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},async batchUpdateVideoConversions(e,t){if(this.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{this.isLoading=!0,this.error=null;const s=e.map(l=>this.getHelper().update(l,t,this.getPhpTableName(),this.getPhpTableKey())),r=await Promise.all(s);return r.forEach(l=>{if(l&&l.ch_id){const u=this.items.findIndex(b=>b.ch_id===l.ch_id);u!==-1&&(this.items[u]=l)}}),this.lastFetched=Date.now(),console.log("일괄 변경 완료:",e.length,"개"),r}catch(s){const r=s instanceof Error?s.message:"알 수 없는 오류",l=s instanceof Error?s.stack:void 0;throw console.error("일괄 변경 실패:",{message:r,stack:l,error:s}),this.error=this.getHelper().parseBackendError(s),s}finally{this.isLoading=!1}},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),we=50,Se=120,xe=f({__name:"VideoConversionInfo",setup(e){const t=ie(),s=E(),r=J(),l=Y(!1),u=Y(null),b=Y(!1),y=Y({}),T=k(()=>{var h;return!((h=u.value)!=null&&h.selectedRowIds)||u.value.selectedRowIds.size===0}),C=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(h){const o=typeof h.value=="boolean"?String(h.value):String(h.value||"");return()=>x("span",{class:"text-sm text-slate-700"},o)}}),L=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(h){const o=typeof h.value=="boolean"?h.value?"active":"inactive":String(h.value||""),m=o==="active"?"bg-green-50 text-green-700":o==="warning"?"bg-orange-50 text-orange-700":"bg-slate-100 text-slate-600",g=o==="active"?"bg-green-500":o==="warning"?"bg-orange-500":"bg-slate-400";return()=>x("span",{class:["inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",m]},[x("span",{class:["w-1.5 h-1.5 rounded-full",g]}),o.toUpperCase()])}}),z=(h,o)=>f({props:{value:{type:[String,Number],default:""}},setup(m){const g=k(()=>m.value?s.getCodeName(h,o,String(m.value)):"");return()=>x("span",{class:"text-sm text-slate-700"},g.value)}}),j=z("C","4"),D=z("C","5"),p=z("C","7"),n=z("C","8"),c=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(h){const o=h.value==="Y"||h.value===!0||h.value==="true";return()=>x("span",{class:["inline-block px-2 py-0.5 rounded text-xs font-bold",o?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"]},o?"Y":"N")}});function v(h){if(h==null||h==="")return"";const o=String(h).trim();return o.length>=10?o.slice(0,10):o}const i=f({props:{value:{type:[String,Number],default:""}},setup(h){return()=>x("span",{class:"text-sm text-slate-700"},v(h.value))}}),_=[{id:"ch_id",header:"채널 구분자",size:120,cellComponent:C},{id:"hq_code",header:"소속 본부",size:120,cellComponent:C},{id:"branch_code",header:"소속 지사",size:120,cellComponent:C},{id:"route_code",header:"노선",size:120,cellComponent:C},{id:"cctv_id",header:"CCTV ID",size:140,cellComponent:C},{id:"trans_id",header:"영상변환 서버 ID",size:140,cellComponent:C},{id:"fms_id",header:"미디어 서버 ID",size:140,cellComponent:C},{id:"ch_venc",header:"인코딩 방식",size:100,cellComponent:D},{id:"ch_vsize",header:"영상 크기",size:100,cellComponent:j},{id:"ch_vfps",header:"FPS",size:80,cellComponent:C},{id:"ch_vkpbs",header:"BPS",size:100,cellComponent:C},{id:"ch_alive",header:"동작여부",size:80,cellComponent:L},{id:"ch_alive_time",header:"최종 확인 시간",size:160,cellComponent:i},{id:"ch_alive_yn",header:"동작 확인 여부",size:100,cellComponent:c},{id:"reg_date",header:"등록 일자",size:160,cellComponent:i},{id:"job_status",header:"동작 상태",size:100,cellComponent:C},{id:"json_job",header:"JSON 작업",size:100,cellComponent:c},{id:"json_yn",header:"JSON 사용",size:100,cellComponent:c},{id:"kt_cctv",header:"KT 개시지점",size:140,cellComponent:C},{id:"ch_wmv_yn",header:"WMV 저장",size:100,cellComponent:c},{id:"ch_wmv_venc",header:"WMV 형식",size:100,cellComponent:p},{id:"ch_wmv_vsize",header:"WMV 크기",size:100,cellComponent:n},{id:"sms_session",header:"SMS 세션",size:140,cellComponent:C},{id:"sms_host_ip",header:"SMS 호스트 IP",size:140,cellComponent:C},{id:"ch_jpg_size",header:"JPG 크기",size:100,cellComponent:n},{id:"ch_jpg_kbps",header:"JPG BPS",size:100,cellComponent:C}],a=["ch_id","hq_code","route_code","cctv_id","trans_id","fms_id","ch_alive","ch_alive_time","reg_date"],d=k(()=>{const h=t.items;return t.error&&console.error("영상변환 채널정보 스토어 에러:",t.error),[...h]}),P=[{id:"ch_id",label:"채널 구분자",type:"text",required:!0,placeholder:"예: CH000XXXXX"},{id:"cctv_id",label:"CCTV ID",type:"text",required:!0,placeholder:"예: CCTV000XXXXX"},{id:"trans_id",label:"영상 변환 서버 ID",type:"text",required:!0,placeholder:"예: TR0000XXXX"},{id:"fms_id",label:"미디어 서버 ID",type:"text",required:!0,placeholder:"예: FMS0000XXXX"},{id:"ch_venc",label:"영상 인코딩 방식",type:"text",required:!0},{id:"ch_vsize",label:"영상 크기",type:"text"},{id:"ch_vfps",label:"영상 FPS",type:"text",placeholder:"2~30"},{id:"ch_vkpbs",label:"영상 BPS",type:"text",placeholder:"00000~99999"},{id:"ch_alive",label:"채널 동작여부",type:"text",placeholder:"Y / N"},{id:"ch_alive_yn",label:"동작 확인 여부",type:"text",placeholder:"Y / N"},{id:"reg_date",label:"등록 일자",type:"text",required:!0,placeholder:"YYYY/MM/DD HH:mm:SS"},{id:"json_job",label:"JSON 작업",type:"text",required:!0,placeholder:"Y / N"},{id:"json_yn",label:"JSON 사용 여부",type:"text",required:!0,placeholder:"Y / N"},{id:"json_date",label:"JSON 사용 시간",type:"text",required:!0,placeholder:"YYYY/MM/DD HH:mm:SS"},{id:"kt_cctv",label:"KT 개시지점 이름",type:"text"},{id:"ch_wmv_yn",label:"WMV 저장 여부",type:"text",placeholder:"Y / N"},{id:"ch_wmv_venc",label:"WMV 저장 형식",type:"text",required:!0},{id:"ch_wmv_vsize",label:"WMV 영상 크기",type:"text",required:!0},{id:"ch_wmv_vfps",label:"WMV FPS",type:"text",placeholder:"2~30"},{id:"ch_wmv_vkpbs",label:"WMV 영상 BPS",type:"text",placeholder:"00000~99999"},{id:"sms_session",label:"SMS 세션 이름",type:"text"},{id:"sms_host_ip",label:"SMS 호스트 IP",type:"text",placeholder:"A.B.C.D 형식"},{id:"sms_date",label:"SMS 전송 날짜",type:"text",placeholder:"YYYY/MM/DD HH:mm:SS"},{id:"job_status",label:"동작 상태",type:"text"},{id:"ch_jpg_size",label:"JPG 크기",type:"text",required:!0},{id:"ch_jpg_kbps",label:"JPG BPS",type:"text",placeholder:"00000~99999"},{id:"ch_jpg_keep_count",label:"JPG 파일 유지 개수",type:"text",placeholder:"0~20"}],N=[{id:"ch_venc",label:"영상 인코딩 방식",type:"text"},{id:"ch_vsize",label:"영상 크기",type:"text"},{id:"ch_vfps",label:"영상 FPS",type:"text"},{id:"ch_vkpbs",label:"영상 BPS",type:"text"},{id:"ch_alive",label:"채널 동작여부",type:"text"},{id:"json_job",label:"JSON 작업",type:"text"},{id:"json_yn",label:"JSON 사용 여부",type:"text"},{id:"ch_wmv_yn",label:"WMV 저장 여부",type:"text"},{id:"ch_jpg_keep_count",label:"JPG 파일 유지 개수",type:"text"}],I=async(h,o)=>{var m,g;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,o?await t.createVideoConversion(h):await t.updateVideoConversion(h.ch_id,h),r.show(o?"신규 생성 완료":"수정 완료","success")}catch(w){console.error("데이터 저장 실패:",w);const M=t.error||((g=(m=w.response)==null?void 0:m.data)==null?void 0:g.detail)||"데이터 저장 중 오류가 발생했습니다.";r.show(M,"error")}finally{l.value=!1}},V=async h=>{var o,m;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,await t.deleteVideoConversions(h),r.show("삭제 완료","success")}catch(g){console.error("데이터 삭제 실패:",g);const w=t.error||((m=(o=g.response)==null?void 0:o.data)==null?void 0:m.detail)||"데이터 삭제 중 오류가 발생했습니다.";r.show(w,"error")}finally{l.value=!1}},te=()=>{u.value&&u.value.selectedRowIds&&u.value.selectedRowIds.size>0?(y.value={},b.value=!0):r.show("선택된 항목이 없습니다.","warning")},Z=()=>{b.value=!1,y.value={}},U=async h=>{var o,m,g;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0;const w=(o=u.value)!=null&&o.selectedRowIds?Array.from(u.value.selectedRowIds):[];if(w.length===0){r.show("선택된 항목이 없습니다.","warning");return}await t.batchUpdateVideoConversions(w,h),Z(),r.show(`일괄 변경 완료: ${w.length}개 항목`,"success")}catch(w){console.error("일괄 변경 실패:",w);const M=t.error||((g=(m=w.response)==null?void 0:m.data)==null?void 0:g.detail)||"일괄 변경 중 오류가 발생했습니다.";r.show(M,"error")}finally{l.value=!1}};return Q(async()=>{try{await t.fetchVideoConversions(),await he()}catch(h){console.error("영상변환 채널정보 로드 실패:",h)}}),(h,o)=>(A(),ne(le,null,[$(W,{ref_key:"tableRef",ref:u,"model-value":d.value,columns:_,"default-visible-columns":a,"form-fields":P,"modal-title":"영상변환 채널정보","checkbox-column-width":we,"id-column-width":Se,"id-field":"ch_id","preference-key":"vms_video_conversion_info",onUpdate:I,onDelete:V},{"toolbar-actions-left":q(()=>[$(O,{onClick:te,variant:"info",disabled:T.value},{default:q(()=>[...o[0]||(o[0]=[B(" 일괄 변경 ",-1)])]),_:1},8,["disabled"])]),_:1},8,["model-value"]),N&&N.length>0?(A(),K(_e,{key:0,"is-open":b.value,title:"일괄 변경",fields:N,"initial-data":y.value||void 0,onClose:Z,onSubmit:U},null,8,["is-open","initial-data"])):me("",!0)],64))}}),Te=R(xe,[["__scopeId","data-v-8aecd9b9"]]),ae=X("videoConversionServerInfo",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.trans_id===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.trans_id.toLowerCase().includes(s)||r.trans_name.toLowerCase().includes(s)||r.trans_ip.toLowerCase().includes(s))}},actions:{transformFromAPI(e){return{trans_id:e.trans_id||"",trans_name:e.trans_name||"",trans_ip:e.trans_ip||"",trans_port:e.trans_port!==void 0?Number(e.trans_port):0,alive:e.alive||"N",alive_time:e.alive_time||null,json_job:e.json_job||"",json_yn:e.json_yn||"N",json_date:e.json_date||null,version:e.version||"",build_date:e.build_date||null,start_date:e.start_date||null}},transformToAPI(e){return{trans_id:e.trans_id,trans_name:e.trans_name,trans_ip:e.trans_ip,trans_port:e.trans_port,alive:e.alive,alive_time:e.alive_time,json_job:e.json_job,json_yn:e.json_yn,json_date:e.json_date,version:e.version,build_date:e.build_date,start_date:e.start_date}},getHelper(){return new G("/video-conversion-server-info",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_TRANS"},getPhpTableKey(){return"TRANS_ID"},async fetchVideoConversionServers(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"영상변환서버 정보 데이터",this.getPhpTableName())},async createVideoConversionServer(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateVideoConversionServer(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteVideoConversionServer(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteVideoConversionServers(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),Pe=50,Ne=150,Me=f({__name:"VideoConversionServerInfo",setup(e){const t=ae(),s=J(),r=Y(!1),l=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(i){const _=typeof i.value=="boolean"?String(i.value):String(i.value||"");return()=>x("span",{class:"text-sm text-slate-700"},_)}}),u=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(i){const _=String(i.value||"").toUpperCase(),a=_==="Y"||_==="TRUE"||i.value===!0,d=a?"bg-green-50 text-green-700":"bg-slate-100 text-slate-600",P=a?"bg-green-500":"bg-slate-400",N=a?"정상":"비활성";return()=>x("span",{class:["inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",d]},[x("span",{class:["w-1.5 h-1.5 rounded-full",P]}),N])}}),b=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(i){const _=i.value==="Y"||i.value===!0||i.value==="true"||String(i.value).toUpperCase()==="Y";return()=>x("span",{class:["inline-block px-2 py-0.5 rounded text-xs font-bold",_?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"]},_?"Y":"N")}});function y(i){if(i==null||i==="")return"";const _=String(i).trim();return _.length>=10?_.slice(0,10):_}const T=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(i){return()=>x("span",{class:"text-sm text-slate-700"},y(i.value))}}),C=[{id:"trans_id",header:"서버 ID",size:120,cellComponent:l},{id:"trans_name",header:"서버 이름",size:150,cellComponent:l},{id:"trans_ip",header:"서버 IP 주소",size:130,cellComponent:l},{id:"trans_port",header:"통신 포트 번호",size:120,cellComponent:l},{id:"alive",header:"동작 여부",size:100,cellComponent:u},{id:"alive_time",header:"마지막 동작 시간",size:180,cellComponent:T},{id:"json_job",header:"JSON 처리",size:120,cellComponent:l},{id:"json_yn",header:"JSON 사용 여부",size:100,cellComponent:b},{id:"json_date",header:"마지막 명령 일자",size:160,cellComponent:T},{id:"version",header:"서버 버전",size:120,cellComponent:l},{id:"build_date",header:"파일 생성 일자",size:160,cellComponent:T},{id:"start_date",header:"서버 시작 시간",size:160,cellComponent:T}],L=["trans_id","trans_name","trans_ip","alive","version","start_date"],z=k(()=>(console.log("영상변환서버 정보 데이터:",t.items.length,"개"),t.error&&console.error("영상변환서버 정보 스토어 에러:",t.error),t.items)),j=[{id:"trans_id",label:"서버 ID",type:"id",required:!0,placeholder:"숫자 4자리",maxLength:4,pattern:"^[0-9]{1,4}$",patternMessage:"숫자 4자리 이하로 입력 가능합니다."},{id:"trans_name",label:"서버 이름",type:"text",required:!0,placeholder:""},{id:"trans_ip",label:"IP 주소",type:"ip",required:!0,placeholder:""},{id:"trans_port",label:"포트 번호",type:"number",required:!0,placeholder:"0~65535",min:0,max:65535,maxLength:5}],D=async(i,_)=>{var a,d;if(r.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{if(r.value=!0,_){const P=String(i.trans_id||"").trim(),N={...i,trans_id:"TR0000"+P};await t.createVideoConversionServer(N)}else await t.updateVideoConversionServer(i.trans_id,i);s.show(_?"신규 생성 완료":"수정 완료","success")}catch(P){console.error("데이터 저장 실패:",P);const N=((d=(a=P.response)==null?void 0:a.data)==null?void 0:d.detail)||t.error||"",I=typeof N=="string"?N:Array.isArray(N)?N.map(U=>(U==null?void 0:U.msg)??U).join(", "):(N==null?void 0:N.message)??"",V=I.toLowerCase(),Z=V.includes("duplicate")||V.includes("already exists")||V.includes("conditionalcheckfailed")||V.includes("key must have")||V.includes("unique")||I.includes("고유 제약")||I.includes("키가 이미 있습니다")||I.includes("이미 있습니다")?"이미 존재하는 서버 ID입니다. 다른 값을 입력해주세요.":I||"데이터 저장 중 오류가 발생했습니다.";s.show(Z,"error")}finally{r.value=!1}},p=async i=>{var _,a;if(r.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{r.value=!0,await t.deleteVideoConversionServers(i),s.show("삭제 완료","success")}catch(d){console.error("데이터 삭제 실패:",d);const P=t.error||((a=(_=d.response)==null?void 0:_.data)==null?void 0:a.detail)||"데이터 삭제 중 오류가 발생했습니다.";s.show(P,"error")}finally{r.value=!1}};Q(async()=>{try{await t.fetchVideoConversionServers(),console.log("영상변환서버 정보 로드 완료:",t.items.length,"개"),t.error&&console.error("영상변환서버 정보 로드 에러:",t.error)}catch(i){console.error("영상변환서버 정보 로드 실패:",i)}});const n=()=>{console.log("재시작 클릭")},c=()=>{console.log("중지 클릭")},v=()=>{console.log("SW 업데이트 클릭")};return(i,_)=>(A(),K(W,{"model-value":z.value,columns:C,"default-visible-columns":L,"form-fields":j,"modal-title":"영상변환서버 정보","checkbox-column-width":Pe,"id-column-width":Ne,"id-field":"trans_id","preference-key":"vms_video_conversion_server_info",onUpdate:D,onDelete:p},{"toolbar-actions-left":q(()=>[$(O,{onClick:n,variant:"info"},{default:q(()=>[..._[0]||(_[0]=[B(" 재시작 ",-1)])]),_:1}),$(O,{onClick:c,variant:"info"},{default:q(()=>[..._[1]||(_[1]=[B(" 중지 ",-1)])]),_:1}),$(O,{onClick:v,variant:"info"},{default:q(()=>[..._[2]||(_[2]=[B(" SW 업데이트 ",-1)])]),_:1})]),_:1},8,["model-value"]))}}),ze=R(Me,[["__scopeId","data-v-99ca5812"]]),ce=X("mediaServerInfo",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.fms_id===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.fms_id.toLowerCase().includes(s)||r.fms_name.toLowerCase().includes(s)||r.fms_ip.toLowerCase().includes(s)||r.svr_type.toLowerCase().includes(s))}},actions:{transformFromAPI(e){return{fms_id:e.fms_id||"",fms_name:e.fms_name||"",fms_ip:e.fms_ip||"",fms_ext_ip:e.fms_ext_ip||null,fms_con_id:e.fms_con_id||"",fms_passwd:e.fms_passwd||"",fms_port:e.fms_port!==void 0?Number(e.fms_port):0,svr_type:e.svr_type||"",alive:e.alive||"N",alive_time:e.alive_time||null,json_job:e.json_job||"",json_yn:e.json_yn||"N"}},transformToAPI(e){return{fms_id:e.fms_id,fms_name:e.fms_name,fms_ip:e.fms_ip,fms_ext_ip:e.fms_ext_ip,fms_con_id:e.fms_con_id,fms_passwd:e.fms_passwd,fms_port:e.fms_port,svr_type:e.svr_type,alive:e.alive,alive_time:e.alive_time,json_job:e.json_job,json_yn:e.json_yn}},getHelper(){return new G("/media-server-info",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_FMS"},getPhpTableKey(){return"FMS_ID"},async fetchMediaServers(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"미디어 서버 정보 데이터",this.getPhpTableName())},async createMediaServer(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateMediaServer(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteMediaServer(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteMediaServers(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),Ie=50,ke=120,De=f({__name:"MediaServerInfo",setup(e){const t=ce(),s=E(),r=J(),l=Y(!1),u=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(a){const d=typeof a.value=="boolean"?String(a.value):String(a.value||"");return()=>x("span",{class:"text-sm text-slate-700"},d)}}),b=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(a){const d=typeof a.value=="boolean"?a.value?"Y":"N":String(a.value||""),P=d==="Y"||d==="active"?"bg-green-50 text-green-700":d==="warning"?"bg-orange-50 text-orange-700":"bg-slate-100 text-slate-600",N=d==="Y"||d==="active"?"bg-green-500":d==="warning"?"bg-orange-500":"bg-slate-400",I=d==="Y"?"정상":d==="N"?"비활성":d.toUpperCase();return()=>x("span",{class:["inline-flex items-center gap-1 px-2 py-1 rounded-full text-xs font-medium",P]},[x("span",{class:["w-1.5 h-1.5 rounded-full",N]}),I])}}),y=f({props:{value:{type:[String,Number],default:""}},setup(a){const d=k(()=>a.value?s.getCodeName("C","11",String(a.value)):"");return()=>x("span",{class:"text-sm text-slate-700"},d.value)}}),T=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(a){const d=a.value==="Y"||a.value===!0||a.value==="true";return()=>x("span",{class:["inline-block px-2 py-0.5 rounded text-xs font-bold",d?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"]},d?"Y":"N")}});function C(a){if(a==null||a==="")return"";const d=String(a).trim();return d.length>=10?d.slice(0,10):d}const L=f({props:{value:{type:[String,Number],default:""}},setup(a){return()=>x("span",{class:"text-sm text-slate-700"},C(a.value))}}),z=[{id:"fms_id",header:"미디어 서버 구분자",size:140,cellComponent:u},{id:"fms_name",header:"미디어 서버 이름",size:150,cellComponent:u},{id:"fms_ip",header:"미디어 서버 IP",size:130,cellComponent:u},{id:"fms_ext_ip",header:"외부 주소",size:130,cellComponent:u},{id:"fms_port",header:"포트 번호",size:100,cellComponent:u},{id:"fms_con_id",header:"사용자 ID",size:120,cellComponent:u},{id:"svr_type",header:"서버 종류",size:120,cellComponent:y},{id:"alive",header:"동작 여부",size:100,cellComponent:b},{id:"alive_time",header:"최종 확인 시간",size:180,cellComponent:L},{id:"json_job",header:"JSON 가능",size:120,cellComponent:u},{id:"json_yn",header:"JSON 사용",size:100,cellComponent:T}],j=["fms_id","fms_name","fms_ip","fms_port","svr_type","alive","alive_time"],D=k(()=>(console.log("미디어 서버 데이터:",t.items.length,"개"),t.error&&console.error("미디어 서버 스토어 에러:",t.error),t.items)),p=[{id:"fms_id",label:"미디어 서버 구분자",type:"text",required:!0,placeholder:"예: FMS0000XXXX"},{id:"fms_name",label:"미디어 서버 이름",type:"text",required:!0,placeholder:"한글/영문"},{id:"fms_ip",label:"미디어 서버 IP 주소",type:"text",required:!0,placeholder:"예: 172.16.33.180"},{id:"fms_ext_ip",label:"외부 주소",type:"text",placeholder:"예: 192.168.1.151"},{id:"fms_port",label:"서버 포트 번호",type:"number",placeholder:"0~65535"},{id:"fms_con_id",label:"사용자 ID",type:"text"},{id:"fms_passwd",label:"사용자 암호",type:"text"},{id:"svr_type",label:"미디어 서버 종류",type:"text",required:!0},{id:"alive",label:"동작 여부",type:"text",placeholder:"Y / N"},{id:"alive_time",label:"최종 확인 시간",type:"text",placeholder:"YYYY/MM/DD HH:mm:SS"},{id:"json_job",label:"JSON 프로토콜 가능 여부",type:"text"},{id:"json_yn",label:"JSON 프로토콜 사용 여부",type:"text",placeholder:"Y / N"}],n=async(a,d)=>{var P,N;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,d?await t.createMediaServer(a):await t.updateMediaServer(a.fms_id,a),r.show(d?"신규 생성 완료":"수정 완료","success")}catch(I){console.error("데이터 저장 실패:",I);const V=t.error||((N=(P=I.response)==null?void 0:P.data)==null?void 0:N.detail)||"데이터 저장 중 오류가 발생했습니다.";r.show(V,"error")}finally{l.value=!1}},c=async a=>{var d,P;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,await t.deleteMediaServers(a),r.show("삭제 완료","success")}catch(N){console.error("데이터 삭제 실패:",N);const I=t.error||((P=(d=N.response)==null?void 0:d.data)==null?void 0:P.detail)||"데이터 삭제 중 오류가 발생했습니다.";r.show(I,"error")}finally{l.value=!1}};Q(async()=>{try{await t.fetchMediaServers(),console.log("미디어 서버 정보 로드 완료:",t.items.length,"개"),t.error&&console.error("미디어 서버 정보 로드 에러:",t.error)}catch(a){console.error("미디어 서버 정보 로드 실패:",a)}});const v=()=>{console.log("재시작 클릭")},i=()=>{console.log("중지 클릭")},_=()=>{console.log("SW 업데이트 클릭")};return(a,d)=>(A(),K(W,{"model-value":D.value,columns:z,"default-visible-columns":j,"form-fields":p,"modal-title":"미디어 서버 정보","checkbox-column-width":Ie,"id-column-width":ke,"id-field":"fms_id","preference-key":"vms_media_server_info",onUpdate:n,onDelete:c},{"toolbar-actions-left":q(()=>[$(O,{onClick:v,variant:"info"},{default:q(()=>[...d[0]||(d[0]=[B(" 재시작 ",-1)])]),_:1}),$(O,{onClick:i,variant:"info"},{default:q(()=>[...d[1]||(d[1]=[B(" 중지 ",-1)])]),_:1}),$(O,{onClick:_,variant:"info"},{default:q(()=>[...d[2]||(d[2]=[B(" SW 업데이트 ",-1)])]),_:1})]),_:1},8,["model-value"]))}}),Le=R(De,[["__scopeId","data-v-e5bd33ea"]]),de=X("videoFileTransferServer",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.fts_id===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.fts_id.toLowerCase().includes(s)||r.fts_name.toLowerCase().includes(s)||r.ip_addr.toLowerCase().includes(s)||r.fts_target_ip.toLowerCase().includes(s))}},actions:{transformFromAPI(e){return{fts_id:e.fts_id||"",fts_name:e.fts_name||"",fts_type:e.fts_type||"",ip_addr:e.ip_addr||"",fts_target_ip:e.fts_target_ip||"",fts_target_root_dir:e.fts_target_root_dir||"",user_id:e.user_id||"",password:e.password||"",reg_date:e.reg_date||null}},transformToAPI(e){return{fts_id:e.fts_id,fts_name:e.fts_name,fts_type:e.fts_type,ip_addr:e.ip_addr,fts_target_ip:e.fts_target_ip,fts_target_root_dir:e.fts_target_root_dir,user_id:e.user_id,password:e.password,reg_date:e.reg_date}},getHelper(){return new G("/video-file-transfer-server",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_FTS"},getPhpTableKey(){return"FTS_ID"},async fetchTransferServers(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"영상 파일 전송 서버 정보 데이터",this.getPhpTableName())},async createTransferServer(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateTransferServer(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteTransferServer(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteTransferServers(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),je=50,Ve=120,qe=f({__name:"VideoFileTransferServer",setup(e){const t=de(),s=E(),r=J(),l=Y(!1),u=f({props:{value:{type:[String,Number],default:""}},setup(p){return()=>x("span",{class:"text-sm text-slate-700"},String(p.value||""))}}),b=f({props:{value:{type:[String,Number],default:""}},setup(p){const n=k(()=>{if(!p.value)return"";const c=String(p.value),v=c.match(/^(\d{4})[/-](\d{2})[/-](\d{2})/);return v?`${v[1]}-${v[2]}-${v[3]}`:c});return()=>x("span",{class:"text-sm text-slate-700"},n.value)}}),y=f({props:{value:{type:[String,Number],default:""}},setup(p){const n=k(()=>p.value?s.getCodeName("C","11",String(p.value)):"");return()=>x("span",{class:"text-sm text-slate-700"},n.value)}}),T=[{id:"fts_id",header:"서버 ID",size:100,cellComponent:u},{id:"fts_name",header:"서버 이름",size:150,cellComponent:u},{id:"fts_type",header:"서버 종류",size:100,cellComponent:y},{id:"ip_addr",header:"IP 주소",size:130,cellComponent:u},{id:"fts_target_ip",header:"대상 서버 IP",size:130,cellComponent:u},{id:"fts_target_root_dir",header:"루트 경로",size:150,cellComponent:u},{id:"user_id",header:"사용자 ID",size:120,cellComponent:u},{id:"reg_date",header:"등록 일자",size:160,cellComponent:b}],C=["fts_id","fts_name","fts_type","ip_addr","fts_target_ip","reg_date"],L=k(()=>t.items),z=[{id:"fts_id",label:"서버 ID",type:"text",required:!0,placeholder:"FTSXX (00~99)"},{id:"fts_name",label:"서버 이름",type:"text",required:!0,placeholder:"한글/영문"},{id:"fts_type",label:"서버 종류",type:"text",required:!0,placeholder:"XXXXX (코드형식)"},{id:"ip_addr",label:"서버 IP 주소",type:"text",required:!0,placeholder:"A.B.C.D"},{id:"fts_target_ip",label:"전송 대상 서버 IP",type:"text",required:!0,placeholder:"A.B.C.D"},{id:"fts_target_root_dir",label:"대상 서버 루트 경로",type:"text",placeholder:"경로 문자열"},{id:"user_id",label:"사용자 ID",type:"text",required:!0,placeholder:"사용자 계정"},{id:"password",label:"사용자 암호",type:"text",required:!0,placeholder:"암호화된 문자열"},{id:"reg_date",label:"등록 일자",type:"text",placeholder:"YYYY-MM-DD"}],j=async(p,n)=>{var c,v;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,n?await t.createTransferServer(p):await t.updateTransferServer(p.fts_id,p),r.show(n?"신규 생성 완료":"수정 완료","success")}catch(i){console.error("데이터 저장 실패:",i);const _=t.error||((v=(c=i.response)==null?void 0:c.data)==null?void 0:v.detail)||"데이터 저장 중 오류가 발생했습니다.";r.show(_,"error")}finally{l.value=!1}},D=async p=>{var n,c;if(l.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{l.value=!0,await t.deleteTransferServers(p),r.show("삭제 완료","success")}catch(v){console.error("데이터 삭제 실패:",v);const i=t.error||((c=(n=v.response)==null?void 0:n.data)==null?void 0:c.detail)||"데이터 삭제 중 오류가 발생했습니다.";r.show(i,"error")}finally{l.value=!1}};return Q(async()=>{try{await t.fetchTransferServers()}catch(p){console.error("영상 파일 전송 서버 정보 로드 실패:",p)}}),(p,n)=>(A(),K(W,{"model-value":L.value,columns:T,"default-visible-columns":C,"form-fields":z,"modal-title":"영상 파일 전송 서버 정보","checkbox-column-width":je,"id-column-width":Ve,"id-field":"fts_id","preference-key":"vms_video_file_transfer_server",onUpdate:j,onDelete:D},null,8,["model-value"]))}}),He=R(qe,[["__scopeId","data-v-db3eafed"]]),$e=X("cameraInfo",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.cctv_id===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.cctv_id.toLowerCase().includes(s)||r.camera_no.toLowerCase().includes(s)||r.hq_code.toLowerCase().includes(s)||r.branch_code.toLowerCase().includes(s)||r.route_code.toLowerCase().includes(s)||r.location.toLowerCase().includes(s)||r.road_name.toLowerCase().includes(s))}},actions:{transformFromAPI(e){var t,s,r,l,u,b;return{cctv_id:e.cctv_id||"",camera_no:((t=e.camera_no)==null?void 0:t.toString())||"",hq_code:e.hq_code||"",branch_code:e.branch_code||"",route_code:e.route_code||"",location:e.location||"",camera_area:e.camera_area||"",enc_url:e.enc_url||"",trans_wms_port:((s=e.trans_wms_port)==null?void 0:s.toString())||"",link_id_s:e.link_id_s||"",link_id_e:e.link_id_e||"",vlink_id_s:e.vlink_id_s||"",vlink_id_e:e.vlink_id_e||"",road_id:e.road_id||"",road_name:e.road_name||"",milepost:((r=e.milepost)==null?void 0:r.toString())||"",bound:e.bound||"",lat:((l=e.lat)==null?void 0:l.toString())||"",lng:((u=e.lng)==null?void 0:u.toString())||"",fileurl_wmv:e.fileurl_wmv||"",fileurl_mp4:e.fileurl_mp4||"",fileurl_img:e.fileurl_img||"",stat:e.stat||"N",alive:e.alive||"N",alive_yn:e.alive_yn||"N",update_date:e.update_date||null,last_cctv_time:e.last_cctv_time||null,hls_url:e.hls_url||"",hls_alive:e.hls_alive||"N",hls_duration:((b=e.hls_duration)==null?void 0:b.toString())||"0",hls_emergency:e.hls_emergency??null,ftp_sent_date:e.ftp_sent_date||null,reg_date:e.reg_date||null}},transformToAPI(e){return{cctv_id:e.cctv_id,camera_no:e.camera_no,hq_code:e.hq_code,branch_code:e.branch_code,route_code:e.route_code,location:e.location,camera_area:e.camera_area,enc_url:e.enc_url,trans_wms_port:e.trans_wms_port,link_id_s:e.link_id_s,link_id_e:e.link_id_e,vlink_id_s:e.vlink_id_s,vlink_id_e:e.vlink_id_e,road_id:e.road_id,road_name:e.road_name,milepost:e.milepost,bound:e.bound,lat:e.lat,lng:e.lng,fileurl_wmv:e.fileurl_wmv,fileurl_mp4:e.fileurl_mp4,fileurl_img:e.fileurl_img,stat:e.stat,alive:e.alive,alive_yn:e.alive_yn,update_date:e.update_date,last_cctv_time:e.last_cctv_time,hls_url:e.hls_url,hls_alive:e.hls_alive,hls_duration:e.hls_duration,hls_emergency:e.hls_emergency,ftp_sent_date:e.ftp_sent_date,reg_date:e.reg_date}},getHelper(){return new G("/camera-info",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_CCTV"},getPhpTableKey(){return"CCTV_ID"},async fetchCameras(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"카메라 정보 데이터",this.getPhpTableName())},async createCamera(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateCamera(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteCamera(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteCameras(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),Ae=50,Fe=120,Ye=f({__name:"CameraInfo",setup(e){const t=$e(),s=E(),r=J(),l=ae(),u=de(),b=ce(),y=ie(),T=k(()=>s.getByGrpGbn("1").filter(o=>String(o.grp_code||"")==="0").map(o=>({value:o.code||"",label:(o.code_name||"").trim()||String(o.code||"")})));function C(o){const m=(o==null?void 0:o.hq_code)??"";return s.getByGrpGbn("2").filter(g=>String(g.grp_code||"")===String(m)).map(g=>({value:g.code||"",label:(g.code_name||"").trim()||String(g.code||"")}))}const L=k(()=>s.getByGrpGbn("4").map(o=>({value:o.code||"",label:(o.code_name||o.short_code_name||"").trim()||String(o.code||"")}))),z=k(()=>l.items.map(o=>({value:o.trans_id,label:`${o.trans_id} (${o.trans_name||""})`}))),j=k(()=>u.items.map(o=>({value:o.fts_id,label:`${o.fts_id} (${o.fts_name||""})`}))),D=k(()=>b.items.map(o=>({value:o.fms_id,label:`${o.fms_id} (${o.fms_name||""})`}))),p=Y(!1),n=f({props:{value:{type:[String,Number],default:""}},setup(o){return()=>x("span",{class:"text-sm text-slate-700"},String(o.value||""))}}),c=f({props:{value:{type:[String,Number],default:""}},setup(o){return()=>x("span",{class:["inline-block px-2 py-0.5 rounded text-xs font-bold",o.value==="Y"?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"]},String(o.value||""))}});function v(o){if(o==null||o==="")return"";const m=String(o).trim(),g=m.match(/^(\d{4}-\d{2}-\d{2})/);if(g)return g[1];const w=m.match(/^(\d{4})-(\d{2})-(\d{2})/);return w?`${w[1]}-${w[2]}-${w[3]}`:m}const i=f({props:{value:{type:[String,Number],default:""}},setup(o){return()=>x("span",{class:"text-sm text-slate-700"},v(o.value))}}),_=f({props:{value:{type:[String,Number],default:""}},setup(o){return()=>x("span",{class:"text-sm text-slate-700"},v(o.value))}}),a=[{id:"cctv_id",header:"카메라 ID",size:140,cellComponent:n},{id:"camera_no",header:"관리 번호",size:100,cellComponent:n},{id:"hq_name",header:"소속 본부",size:120,cellComponent:n},{id:"branch_name",header:"소속 지사",size:120,cellComponent:n},{id:"route_name",header:"노선",size:120,cellComponent:n},{id:"location",header:"설치 위치",size:120,cellComponent:n},{id:"camera_area",header:"설치 지역",size:150,cellComponent:n},{id:"enc_url",header:"인코더 URL",size:200,cellComponent:n},{id:"trans_wms_port",header:"WMS 포트",size:120,cellComponent:n},{id:"link_id_s",header:"링크 시작",size:100,cellComponent:n},{id:"link_id_e",header:"링크 종료",size:100,cellComponent:n},{id:"vlink_id_s",header:"가상 링크 시작",size:110,cellComponent:n},{id:"vlink_id_e",header:"가상 링크 종료",size:110,cellComponent:n},{id:"road_id",header:"고속도로 ID",size:100,cellComponent:n},{id:"road_name",header:"고속도로 명",size:150,cellComponent:n},{id:"milepost",header:"이정",size:100,cellComponent:n},{id:"bound",header:"설치 방향",size:100,cellComponent:n},{id:"lat",header:"경도",size:120,cellComponent:n},{id:"lng",header:"위도",size:120,cellComponent:n},{id:"fileurl_wmv",header:"WMV 경로",size:160,cellComponent:n},{id:"fileurl_mp4",header:"MP4 경로",size:180,cellComponent:n},{id:"fileurl_img",header:"정지영상 경로",size:160,cellComponent:n},{id:"stat",header:"처리 중",size:90,cellComponent:c},{id:"alive",header:"동작 여부",size:90,cellComponent:c},{id:"alive_yn",header:"ALIVE 사용",size:90,cellComponent:c},{id:"update_date",header:"수정 일자",size:160,cellComponent:_},{id:"last_cctv_time",header:"마지막 CCTV 시간",size:160,cellComponent:_},{id:"hls_url",header:"HLS URL",size:200,cellComponent:n},{id:"hls_alive",header:"HLS 동작",size:90,cellComponent:c},{id:"hls_duration",header:"HLS 지속(초)",size:100,cellComponent:n},{id:"hls_emergency",header:"응급 URL",size:90,cellComponent:c},{id:"ftp_sent_date",header:"FTP 전송 시간",size:160,cellComponent:_},{id:"reg_date",header:"등록 일자",size:120,cellComponent:i}],d=["camera_no","hq_name","branch_name","route_name","location","road_name","alive","reg_date"],P=k(()=>{const o=s.getCodeName,m=s.getCodeNameByGbn,g=y.items;return t.items.map(w=>{const M=g.find(S=>String(S.cctv_id||"").trim()===String(w.cctv_id||"").trim());return{...w,hq_name:o("1","0",w.hq_code||"")||w.hq_code,branch_name:o("2",w.hq_code||"",w.branch_code||"")||w.branch_code,route_name:m("4",w.route_code||"")||w.route_code,trans_id:(M==null?void 0:M.trans_id)??"",fts_id:(M==null?void 0:M.fts_id)??"",fms_id:(M==null?void 0:M.fms_id)??""}})}),N=k(()=>[{id:"cctv_id",label:"",type:"hidden"},{id:"camera_no",label:"카메라 번호",type:"id",required:!0,placeholder:"숫자 4자리",maxLength:4,pattern:"^[0-9]{1,4}$",patternMessage:"숫자 4자리만 입력 가능합니다."},{id:"hq_code",label:"소속 본부",type:"select",required:!0,placeholder:"본부 선택",options:T.value},{id:"branch_code",label:"소속 지사",type:"select",required:!0,placeholder:"소속 본부 선택 후 선택 가능",options:C,disabled:o=>((o==null?void 0:o.hq_code)??"")===""},{id:"route_code",label:"노선",type:"select",required:!0,placeholder:"노선 선택",options:L.value},{id:"road_name",label:"고속도로 이름",type:"text",placeholder:""},{id:"road_id",label:"고속도로 ID",type:"text",placeholder:""},{id:"enc_url",label:"Encoder URL",type:"text",required:!0,placeholder:"rtsp://<분배서버-IP>/<카메라-IP>:ch<채널>:<해상도>"},{id:"hls_url",label:"HLS URL",type:"text",required:!0,placeholder:"http://live1.cdn.com/cctv1/playlist.m3u8"},{id:"public_url",label:"공인 URL",type:"text",required:!0,placeholder:"rtmp://... 또는 rtsp://..."},{id:"trans_id",label:"변환 서버",type:"select",required:!0,placeholder:"영상 변환 서버 선택",options:z.value},{id:"fts_id",label:"파일 제공 서버",type:"select",required:!0,placeholder:"파일 제공 서버 선택",options:j.value},{id:"fms_id",label:"미디어 서버",type:"select",required:!0,placeholder:"미디어 서버 선택",options:D.value},{id:"milepost",label:"이정",type:"text",required:!0,placeholder:"120.00"},{id:"camera_area",label:"설치 지역",type:"text",required:!0,placeholder:""},{id:"stream_purpose",label:"스트림 용도 구분",type:"select",placeholder:"미디어 서버 선택 후 선택 가능",disabled:o=>((o==null?void 0:o.fms_id)??"")==="",options:[{value:"Live",label:"Live"},{value:"VoD",label:"VoD"}]},{id:"trans_wms_port",label:"WMS Port",type:"number",placeholder:"숫자 최대 5자리",maxLength:5,max:99999},{id:"link_id_s",label:"링크 시작점",type:"text",placeholder:"표준 노드 링크 시작"},{id:"link_id_e",label:"링크 종료점",type:"text",placeholder:"표준 노드 링크 종료"},{id:"bound",label:"설치 방향",type:"text",placeholder:"설치 방향"},{id:"lng",label:"경도 좌표",type:"text",placeholder:"",pattern:"^-?\\d*\\.?\\d*$",patternMessage:"숫자만 입력 가능합니다."},{id:"lat",label:"위도 좌표",type:"text",placeholder:"",pattern:"^-?\\d*\\.?\\d*$",patternMessage:"숫자만 입력 가능합니다."}]),I=["cctv_id","camera_no","hq_code","branch_code","route_code","location","camera_area","enc_url","trans_wms_port","link_id_s","link_id_e","vlink_id_s","vlink_id_e","road_id","road_name","milepost","bound","lat","lng","fileurl_wmv","fileurl_mp4","fileurl_img","stat","alive","alive_yn","update_date","last_cctv_time","hls_url","hls_alive","hls_duration","hls_emergency","ftp_sent_date","reg_date"];function V(o){const m={};for(const g of I)Object.prototype.hasOwnProperty.call(o,g)&&(m[g]=o[g]);return m}const te=async(o,m)=>{var g,w;if(p.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{p.value=!0;const M=m?o:(()=>{const F=t.items.find(H=>H.cctv_id===o.cctv_id);return F?{...F,...o}:o})(),S=V(M);if(m){const F=String(S.camera_no??"").replace(/\D/g,"").slice(0,4);S.cctv_id="CCTV0000"+F.padStart(4,"0");const H=new Date,ee=`${H.getFullYear()}-${String(H.getMonth()+1).padStart(2,"0")}-${String(H.getDate()).padStart(2,"0")} ${String(H.getHours()).padStart(2,"0")}:${String(H.getMinutes()).padStart(2,"0")}:${String(H.getSeconds()).padStart(2,"0")}`;S.reg_date=ee,S.stat=S.stat??"N",S.alive=S.alive??"N",S.hls_alive=S.hls_alive??"N",S.alive_yn=S.alive_yn??"N",S.hls_duration=S.hls_duration??"0",S.update_date=S.update_date??ee,S.last_cctv_time=S.last_cctv_time??ee,S.ftp_sent_date=S.ftp_sent_date??ee,await t.createCamera(S)}else await t.updateCamera(S.cctv_id,S);r.show(m?"신규 생성 완료":"수정 완료","success")}catch(M){console.error("데이터 저장 실패:",M);const S=((w=(g=M.response)==null?void 0:g.data)==null?void 0:w.detail)||t.error||"",F=typeof S=="string"?S:Array.isArray(S)?S.map(re=>(re==null?void 0:re.msg)??re).join(", "):(S==null?void 0:S.message)??"",H=F.toLowerCase(),ue=H.includes("duplicate")||H.includes("already exists")||H.includes("conditionalcheckfailed")||H.includes("key must have")||H.includes("unique")||F.includes("고유 제약")||F.includes("키가 이미 있습니다")||F.includes("이미 있습니다")?"이미 존재하는 카메라 ID입니다. 다른 값을 입력해주세요.":F||"데이터 저장 중 오류가 발생했습니다.";r.show(ue,"error")}finally{p.value=!1}},Z=async o=>{var m,g;if(p.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{p.value=!0,await t.deleteCameras(o),r.show("삭제 완료","success")}catch(w){console.error("데이터 삭제 실패:",w);const M=t.error||((g=(m=w.response)==null?void 0:m.data)==null?void 0:g.detail)||"데이터 삭제 중 오류가 발생했습니다.";r.show(M,"error")}finally{p.value=!1}};Q(()=>{t.fetchCameras(),s.fetchCommonCodes(),l.fetchVideoConversionServers(),u.fetchTransferServers(),b.fetchMediaServers(),y.fetchVideoConversions()});const U=()=>{console.log("서버 할당 클릭")},h=()=>{console.log("CDN 연계 정보 생성 클릭")};return(o,m)=>(A(),K(W,{"model-value":P.value,columns:a,"default-visible-columns":d,"form-fields":N.value,"modal-title":"카메라 정보","modal-size":"large","checkbox-column-width":Ae,"id-column-width":Fe,"id-field":"cctv_id","hide-id-column":!0,"preference-key":"vms_camera_info",onUpdate:te,onDelete:Z},{"toolbar-actions-left":q(()=>[$(O,{onClick:U,variant:"info"},{default:q(()=>[...m[0]||(m[0]=[B(" 서버 할당 ",-1)])]),_:1}),$(O,{onClick:h,variant:"info"},{default:q(()=>[...m[1]||(m[1]=[B(" CDN 연계 정보 생성 ",-1)])]),_:1})]),_:1},8,["model-value","form-fields"]))}}),Oe=R(Ye,[["__scopeId","data-v-7e9a607e"]]),Be=X("mediaInfo",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.seq===t),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.seq.toLowerCase().includes(s)||r.camid.toLowerCase().includes(s)||r.title.toLowerCase().includes(s))}},actions:{transformFromAPI(e){var t,s,r;return{seq:((t=e.seq)==null?void 0:t.toString())||"",gbn:((s=e.gbn)==null?void 0:s.toString())||"",camid:((r=e.camid)==null?void 0:r.toString())||"",title:e.title||"",rtmp:e.rtmp||"",live:e.live||"",stream:e.stream||"",stream1:e.stream1||"",kt_cctv:e.kt_cctv||"",state:e.state||"N",reg_date:e.reg_date||null}},transformToAPI(e){return{seq:e.seq,gbn:e.gbn,camid:e.camid,title:e.title,rtmp:e.rtmp,live:e.live,stream:e.stream,stream1:e.stream1,kt_cctv:e.kt_cctv,state:e.state,reg_date:e.reg_date}},getHelper(){return new G("/media-info",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_MEDIA_INFO"},getPhpTableKey(){return"SEQ"},async fetchMediaList(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"미디어 정보 데이터",this.getPhpTableName())},async createMedia(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateMedia(e,t){return await this.getHelper().update(e,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteMedia(e){await this.getHelper().delete(e,this.getPhpTableName(),this.getPhpTableKey())},async deleteMediaList(e){await this.getHelper().deleteMany(e,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),Ue=50,Ke=120,Re=f({__name:"MediaInfo",setup(e){const t=Be(),s=J(),r=Y(!1),l=f({props:{value:{type:[String,Number],default:""}},setup(n){return()=>x("span",{class:"text-sm text-slate-700"},String(n.value||""))}}),u=f({props:{value:{type:[String,Number,Boolean],default:""}},setup(n){const c=n.value==="Y"||n.value===!0||n.value==="true"||String(n.value).toUpperCase()==="Y";return()=>x("span",{class:["inline-block px-2 py-0.5 rounded text-xs font-bold",c?"bg-blue-100 text-blue-700":"bg-slate-100 text-slate-500"]},c?"Y":"N")}});function b(n){if(n==null||n==="")return"";const c=String(n).trim();return c.length>=10?c.slice(0,10):c}const y=f({props:{value:{type:[String,Number],default:""}},setup(n){return()=>x("span",{class:"text-sm text-slate-700"},b(n.value))}}),T=[{id:"seq",header:"미디어 번호",size:100,cellComponent:l},{id:"gbn",header:"구분 번호",size:100,cellComponent:l},{id:"camid",header:"카메라 번호",size:100,cellComponent:l},{id:"title",header:"내용 (타이틀)",size:150,cellComponent:l},{id:"rtmp",header:"RTMP 경로",size:150,cellComponent:l},{id:"live",header:"Live 경로",size:150,cellComponent:l},{id:"stream",header:"스트림 URL",size:200,cellComponent:l},{id:"stream1",header:"스트림 URL 1",size:200,cellComponent:l},{id:"kt_cctv",header:"KT 시작 지점",size:120,cellComponent:l},{id:"state",header:"상태",size:90,cellComponent:u},{id:"reg_date",header:"등록 일자",size:160,cellComponent:y}],C=["seq","camid","title","state","reg_date"],L=k(()=>t.items),z=[{id:"seq",label:"미디어 번호",type:"text",required:!0,placeholder:"00000~99999"},{id:"gbn",label:"구분 번호",type:"text",placeholder:"코드(C1)"},{id:"camid",label:"카메라 번호",type:"text",required:!0,placeholder:"00000~99999"},{id:"title",label:"내용 (타이틀)",type:"text",placeholder:"한글/영문"},{id:"rtmp",label:"RTMP 경로 이름",type:"text",placeholder:"스트리밍 경로"},{id:"live",label:"Live 경로 이름",type:"text",placeholder:"스트리밍 경로"},{id:"stream",label:"최종 스트림 URL",type:"text",placeholder:"URL 형식"},{id:"stream1",label:"최종 스트림 URL 1",type:"text",placeholder:"URL 형식"},{id:"kt_cctv",label:"KT 시작 지점",type:"text",placeholder:"한글/영문"},{id:"state",label:"현재 상태",type:"text",placeholder:"Y / N"},{id:"reg_date",label:"등록 일자",type:"text",placeholder:"YYYY/MM/DD HH:mm:SS"}],j=async(n,c)=>{var v,i;if(r.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{r.value=!0,c?await t.createMedia(n):await t.updateMedia(n.seq,n),s.show(c?"신규 생성 완료":"수정 완료","success")}catch(_){console.error("데이터 저장 실패:",_);const a=t.error||((i=(v=_.response)==null?void 0:v.data)==null?void 0:i.detail)||"데이터 저장 중 오류가 발생했습니다.";s.show(a,"error")}finally{r.value=!1}},D=async n=>{var c,v;if(r.value||t.isLoading){console.warn("이미 처리 중인 요청이 있습니다.");return}try{r.value=!0,await t.deleteMediaList(n),s.show("삭제 완료","success")}catch(i){console.error("데이터 삭제 실패:",i);const _=t.error||((v=(c=i.response)==null?void 0:c.data)==null?void 0:v.detail)||"데이터 삭제 중 오류가 발생했습니다.";s.show(_,"error")}finally{r.value=!1}},p=()=>{console.log("전송 이력 보기 버튼 클릭")};return Q(async()=>{try{await t.fetchMediaList()}catch(n){console.error("미디어 정보 로드 실패:",n)}}),(n,c)=>(A(),K(W,{"model-value":L.value,columns:T,"default-visible-columns":C,"form-fields":z,"modal-title":"미디어 정보","checkbox-column-width":Ue,"id-column-width":Ke,"id-field":"seq","preference-key":"vms_media_info",onUpdate:j,onDelete:D},{"toolbar-actions-left":q(()=>[$(O,{onClick:p,variant:"info"},{default:q(()=>[...c[0]||(c[0]=[B(" 전송 이력 보기 ",-1)])]),_:1})]),_:1},8,["model-value"]))}}),Ee=R(Re,[["__scopeId","data-v-e17aec3d"]]),We=X("versionMgt",{state:()=>({items:[],isLoading:!1,error:null,lastFetched:null}),getters:{totalCount:e=>e.items.length,getById:e=>t=>e.items.find(s=>s.version_id===t),getByProduct:e=>t=>e.items.filter(s=>s.product_name.toLowerCase().includes(t.toLowerCase())),search:e=>t=>{const s=t.toLowerCase();return e.items.filter(r=>r.version_id.toLowerCase().includes(s)||r.product_name.toLowerCase().includes(s)||r.version.toLowerCase().includes(s))}},actions:{transformFromAPI(e){return{id:e.id,version_id:e.key||e.version_id,product_name:e.product||e.product_name,version:e.version||e.version,storage_path:e.path||e.storage_path,release_date:e.release_date||e.release_date,created_at:e.created_at,updated_at:e.updated_at}},transformToAPI(e){return{key:e.key||e.version_id,product:e.product||e.product_name,version:e.version,path:e.path||e.storage_path,release_date:e.release_date}},getHelper(){return new G("/version-mgt",this.transformFromAPI.bind(this),this.transformToAPI.bind(this),this.$state)},getPhpTableName(){return"MGMT_VERSION"},getPhpTableKey(){return"KEY,PRODUCT"},async fetchVersions(e=!1){await this.getHelper().fetchAll(e,5*60*1e3,"버전 관리 데이터",this.getPhpTableName())},async createVersion(e){return await this.getHelper().create(e,this.getPhpTableName(),this.getPhpTableKey())},async updateVersion(e,t){const s=this.items.find(u=>u.version_id===e),r=t.product_name||(s==null?void 0:s.product_name)||"",l=`${e},${r}`;return await this.getHelper().update(l,t,this.getPhpTableName(),this.getPhpTableKey())},async deleteVersion(e){const t=this.items.find(r=>r.version_id===e);if(!t)throw new Error(`버전 ID ${e}를 찾을 수 없습니다.`);const s=`${t.version_id},${t.product_name}`;await this.getHelper().delete(s,this.getPhpTableName(),this.getPhpTableKey())},async deleteVersions(e){const t=e.map(s=>{const r=this.items.find(l=>l.version_id===s);if(!r)throw new Error(`버전 ID ${s}를 찾을 수 없습니다.`);return`${r.version_id},${r.product_name}`});await this.getHelper().deleteMany(t,this.getPhpTableName(),this.getPhpTableKey())},clear(){this.items=[],this.error=null,this.lastFetched=null}}}),Xe=50,Ge=120,Je=f({__name:"VersionManagement",setup(e){const t=We(),s=J(),r=f({props:{value:{type:[String,Number],default:""}},setup(n){return()=>x("span",{class:"text-sm text-slate-700"},String(n.value||""))}});function l(n){if(n==null||n==="")return"";const c=String(n).trim();return c.length>=10?c.slice(0,10):c}const u=f({props:{value:{type:[String,Number],default:""}},setup(n){return()=>x("span",{class:"text-sm text-slate-700"},l(n.value))}}),b=[150,120,200,120],y=[{id:"product_name",header:"제품",size:b[0],cellComponent:r},{id:"version",header:"버전",size:b[1],cellComponent:r},{id:"storage_path",header:"저장 경로",size:b[2],cellComponent:r},{id:"release_date",header:"배포일자",size:b[3],cellComponent:u}],T=["product_name","version","storage_path","release_date"],C=k(()=>t.items),L=[{id:"version_id",label:"",type:"hidden"},{id:"product_name",label:"제품명",type:"text",required:!0,placeholder:"예: TCS7000",readonlyInEdit:!0},{id:"version",label:"버전",type:"text",required:!0,placeholder:"예: v1.5.2"},{id:"storage_path",label:"저장 경로",type:"text",required:!1,placeholder:"예: /opt/cctv/bin"},{id:"release_date",label:"",type:"hidden"}];function z(){return typeof crypto<"u"&&typeof crypto.randomUUID=="function"?crypto.randomUUID():`VER_${Date.now()}_${Math.random().toString(36).slice(2,11)}`}function j(){const n=new Date,c=n.getFullYear(),v=String(n.getMonth()+1).padStart(2,"0"),i=String(n.getDate()).padStart(2,"0"),_=String(n.getHours()).padStart(2,"0"),a=String(n.getMinutes()).padStart(2,"0"),d=String(n.getSeconds()).padStart(2,"0");return`${c}-${v}-${i} ${_}:${a}:${d}`}const D=async(n,c)=>{var v,i;try{if(c){const _={...n,version_id:z(),release_date:j()};await t.createVersion(_)}else await t.updateVersion(n.version_id,n);s.show(c?"신규 생성 완료":"수정 완료","success")}catch(_){console.error("데이터 저장 실패:",_);const a=((i=(v=_.response)==null?void 0:v.data)==null?void 0:i.detail)||t.error||"",d=typeof a=="string"?a:Array.isArray(a)?a.map(V=>(V==null?void 0:V.msg)??V).join(", "):(a==null?void 0:a.message)??"",P=d.toLowerCase(),I=P.includes("duplicate")||P.includes("already exists")||P.includes("conditionalcheckfailed")||P.includes("key must have")||P.includes("unique")||d.includes("고유 제약")||d.includes("키가 이미 있습니다")||d.includes("이미 있습니다")?"이미 존재하는 버전 ID 또는 제품명 조합입니다. 다른 값을 입력해주세요.":d||"데이터 저장 중 오류가 발생했습니다.";s.show(I,"error")}},p=async n=>{var c,v;try{await t.deleteVersions(n),s.show("삭제 완료","success")}catch(i){console.error("데이터 삭제 실패:",i);const _=t.error||((v=(c=i.response)==null?void 0:c.data)==null?void 0:v.detail)||"데이터 삭제 중 오류가 발생했습니다.";s.show(_,"error")}};return Q(()=>{t.fetchVersions()}),(n,c)=>(A(),K(W,{"model-value":C.value,columns:y,"default-visible-columns":T,"form-fields":L,"modal-title":"버전 관리","checkbox-column-width":Xe,"id-column-width":Ge,"id-field":"version_id","hide-id-column":!0,"preference-key":"vms_version_management","hide-edit-button":!0,onUpdate:D,onDelete:p},null,8,["model-value"]))}}),Qe=R(Je,[["__scopeId","data-v-266033dd"]]),Ze={class:"device-management-container"},et={class:"tabs-container"},tt={class:"tabs-header"},rt=["onClick"],st={class:"tabs-content"},nt=f({__name:"DeviceManagementView",setup(e){const t={template:`
    <div class="virtual-server-info-placeholder">
      <div class="placeholder-content">
        <p class="placeholder-text">가상서버 정보</p>
        <p class="placeholder-subtext">구현 예정</p>
      </div>
    </div>
  `},s=["영상변환서버 정보","가상서버 정보","영상 파일 전송 서버","미디어 서버 정보","카메라 정보","미디어 정보","영상변환 채널정보","버전 관리"],r={"영상변환서버 정보":ze,"가상서버 정보":t,"영상 파일 전송 서버":He,"미디어 서버 정보":Le,"카메라 정보":Oe,"미디어 정보":Ee,"영상변환 채널정보":Te,"버전 관리":Qe},l=Y(s[0]),u=b=>{l.value=b};return(b,y)=>(A(),ne("div",Ze,[se("div",et,[se("div",tt,[(A(),ne(le,null,ve(s,T=>se("button",{key:T,onClick:C=>u(T),class:fe(["tab-button",{active:l.value===T}])},ge(T),11,rt)),64))]),se("div",st,[(A(),K(be(r[l.value])))])])]))}}),it=R(nt,[["__scopeId","data-v-ccbb6152"]]);export{it as default};
