import{d as V,u as D,a as I,r as c,c as g,b as e,e as x,w as N,f as v,v as m,g as C,t as k,h as A,o as w,_ as E,i as b,j as L}from"./index-DUpAoUQv.js";import{s as q}from"./crypto-6rmKMyJD.js";const B={class:"login-page"},M={class:"login-wrap"},R={class:"login-card"},H={class:"field"},T={class:"field"},U=["disabled"],j={key:0,class:"btn-loading"},O=V({__name:"LoginView",setup(z){const _=A(),d=D(),h=I(),u=c(""),p=c(""),n=c(!1);function y(a){var i,l,f,r;const s=(i=a.response)==null?void 0:i.status,t=(f=(l=a.response)==null?void 0:l.data)==null?void 0:f.detail,o=typeof t=="string"?t:Array.isArray(t)?((r=t[0])==null?void 0:r.msg)??"":"";return s===401?"사용자 ID 또는 비밀번호가 올바르지 않습니다.":s===400?/nonce|NONCE/i.test(o)?"보안 인증이 만료되었습니다. 페이지를 새로고침한 뒤 다시 로그인해 주세요.":/user_id|password|required/i.test(o)?"사용자 ID와 비밀번호를 모두 입력해 주세요.":o||"입력 내용을 확인해 주세요.":s===404?"로그인 서비스를 찾을 수 없습니다. 서버 설정을 확인하거나 잠시 후 다시 시도해 주세요.":s===503||s===502?"일시적으로 로그인할 수 없습니다. 잠시 후 다시 시도해 주세요.":s>=500?"서버 오류가 발생했습니다. 잠시 후 다시 시도해 주세요.":a.message==="Network Error"||!s?"서버에 연결할 수 없습니다. 네트워크와 서버 상태를 확인해 주세요.":o||"로그인에 실패했습니다. 다시 시도해 주세요."}const S=async()=>{var t;const a=u.value.trim(),s=p.value;if(!a||!s){d.show("사용자 ID와 비밀번호를 입력하세요.","warning");return}n.value=!0;try{const i=(t=(await b.get("/api/auth/nonce")).data)==null?void 0:t.nonce;if(!i){d.show("보안 토큰을 받지 못했습니다. 페이지를 새로고침한 뒤 다시 시도해 주세요.","error");return}const l=await q(s),r=(await b.post("/api/auth/login",{user_id:a,password:l,nonce:i})).data.user;h.login({id:r.id,name:r.name,email:r.email||""}),_.push("/")}catch(o){d.show(y(o),"error")}finally{n.value=!1}};return(a,s)=>(w(),g("div",B,[s[6]||(s[6]=e("div",{class:"login-bg"},null,-1)),e("div",M,[e("div",R,[s[4]||(s[4]=x('<div class="login-header" data-v-5fbf56de><div class="login-logo" data-v-5fbf56de><img src="'+E+'" alt="로고" data-v-5fbf56de><span data-v-5fbf56de>한국도로공사</span></div><h1 class="login-title" data-v-5fbf56de>CCTV 통합 관제 시스템</h1><p class="login-subtitle" data-v-5fbf56de>시스템 이용을 위해 로그인해 주세요.</p></div>',1)),e("form",{onSubmit:N(S,["prevent"]),class:"login-form"},[e("div",H,[s[2]||(s[2]=e("label",{for:"user_id"},"사용자 ID",-1)),v(e("input",{id:"user_id","onUpdate:modelValue":s[0]||(s[0]=t=>u.value=t),type:"text",autocomplete:"username",required:"",placeholder:"사용자 ID를 입력하세요"},null,512),[[m,u.value]])]),e("div",T,[s[3]||(s[3]=e("label",{for:"password"},"비밀번호",-1)),v(e("input",{id:"password","onUpdate:modelValue":s[1]||(s[1]=t=>p.value=t),type:"password",autocomplete:"current-password",required:"",placeholder:"비밀번호를 입력하세요"},null,512),[[m,p.value]])]),e("button",{type:"submit",class:"btn-login",disabled:n.value},[n.value?(w(),g("span",j)):C("",!0),e("span",null,k(n.value?"로그인 중...":"로그인"),1)],8,U)],32),s[5]||(s[5]=e("p",{class:"login-footer"},"계정이 없으시면 시스템 관리자에게 문의해 주세요.",-1))])])]))}}),J=L(O,[["__scopeId","data-v-5fbf56de"]]);export{J as default};
